# Audio Switcher - 音频输出切换器

一键切换 Windows 音频输出设备（扬声器、耳机等）的快捷工具。

## 功能特点

- 🔊 快速切换音频输出设备
- 🎤 **按键录制** - 点击录制按钮，按下键盘组合键即可设置热键
- ⌨️ 为每个设备配置专属热键
- 🖥️ 简洁的图形界面
- 🌐 全局热键支持（即使窗口最小化也能使用）
- 💾 自动保存热键配置
- 📦 专业安装程序，一键安装

## 系统要求

- Windows 10/11
- 需要管理员权限（用于全局热键功能）

## 安装方法

### 方法一：使用安装程序（推荐）

1. 下载 `AudioSwitcher_Setup.exe`
2. 双击运行安装程序
3. 按照向导完成安装
4. 安装完成后自动启动程序

### 方法二：使用便携版

1. 下载 `AudioSwitcher.exe`
2. 右键点击 → 属性 → 兼容性 → 勾选"以管理员身份运行此程序"
3. 双击运行

### 方法三：从源码运行（开发者）

```bash
# 安装依赖
pip install -r requirements.txt

# 运行程序（需要管理员权限）
python audio_switcher.py
```

## 使用说明

### 基本操作

1. **查看可用设备**: 程序会自动显示所有音频输出设备
2. **手动切换**:
   - 从列表中选择设备
   - 点击"切换到选定设备"
3. **设置热键**:
   - 从列表中选择设备
   - 点击"🎤 录制热键"按钮
   - 按下你想要的组合键（如 Ctrl+Shift+1）
   - 按键会自动被检测并显示
   - 点击"✓ 应用到选定设备"
   - 完成！即使窗口最小化，热键也能正常工作

### 热键示例

- `Ctrl+Shift+1` - 切换到设备1
- `Ctrl+Shift+2` - 切换到设备2
- `Alt+S` - 切换到扬声器
- `Alt+H` - 切换到耳机

### 配置文件

热键配置会自动保存到 `audio_config.json`，重启程序后会自动恢复。

## 构建安装程序

如果你想自己构建安装程序：

1. 安装 [Inno Setup](https://jrsoftware.org/isdl.php)
2. 运行 `build_installer.bat`
3. 安装程序会生成在 `installer_output` 文件夹

或者只构建可执行文件：
```bash
build_exe.bat
```

## 常见问题

### 热键不工作

- 确保以管理员权限运行程序
- Windows 全局热键需要管理员权限

### 设备列表为空

- 点击"刷新设备"按钮
- 确保音频设备已连接并在 Windows 声音设置中启用

### 无法切换设备

- 某些设备可能需要额外的 Windows 权限
- 尝试断开并重新连接设备
- 检查 Windows 声音设置确保设备已启用

### 热键冲突

- 如果热键不工作，可能与其他程序冲突
- 尝试使用不同的组合键
- 关闭可能使用相同热键的其他程序

## 技术实现

本程序使用以下技术：
- **pycaw** - Windows Core Audio API 控制库
- **keyboard** - 全局热键注册库
- **tkinter** - GUI 界面库
- **PyInstaller** - 可执行文件打包工具
- **Inno Setup** - 专业安装程序制作工具

## 开源协议

免费使用和修改，仅供个人使用。

## 项目地址

https://github.com/Zayn407/audio-switcher
